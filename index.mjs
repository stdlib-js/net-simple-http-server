// Copyright (c) 2022 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
/// <reference types="./index.d.ts" />
import e from"https://cdn.jsdelivr.net/gh/stdlib-js/process-cwd@esm/index.mjs";import r from"https://cdn.jsdelivr.net/gh/stdlib-js/net-http-server@esm/index.mjs";import t from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-function@esm/index.mjs";import n from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-open-url@esm/index.mjs";import i from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-noop@esm/index.mjs";import o from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-boolean@esm/index.mjs";import s from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-string@esm/index.mjs";import u from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-plain-object@esm/index.mjs";import l from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-has-own-property@esm/index.mjs";import a from"https://cdn.jsdelivr.net/gh/stdlib-js/fs-read-dir@esm/index.mjs";import f from"https://cdn.jsdelivr.net/gh/stdlib-js/buffer-from-string@esm/index.mjs";function c(e){if(e.__esModule)return e;var r=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})})),r}function d(e,r){for(var t=0,n=e.length-1;n>=0;n--){var i=e[n];"."===i?e.splice(n,1):".."===i?(e.splice(n,1),t++):t&&(e.splice(n,1),t--)}if(r)for(;t--;t)e.unshift("..");return e}var p=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,m=function(e){return p.exec(e).slice(1)};function h(){for(var e="",r=!1,t=arguments.length-1;t>=-1&&!r;t--){var n=t>=0?arguments[t]:"/";if("string"!=typeof n)throw new TypeError("Arguments to path.resolve must be strings");n&&(e=n+"/"+e,r="/"===n.charAt(0))}return(r?"/":"")+(e=d(E(e.split("/"),(function(e){return!!e})),!r).join("/"))||"."}function v(e){var r=g(e),t="/"===O(e,-1);return(e=d(E(e.split("/"),(function(e){return!!e})),!r).join("/"))||r||(e="."),e&&t&&(e+="/"),(r?"/":"")+e}function g(e){return"/"===e.charAt(0)}function b(){var e=Array.prototype.slice.call(arguments,0);return v(E(e,(function(e,r){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))}function j(e,r){function t(e){for(var r=0;r<e.length&&""===e[r];r++);for(var t=e.length-1;t>=0&&""===e[t];t--);return r>t?[]:e.slice(r,t-r+1)}e=h(e).substr(1),r=h(r).substr(1);for(var n=t(e.split("/")),i=t(r.split("/")),o=Math.min(n.length,i.length),s=o,u=0;u<o;u++)if(n[u]!==i[u]){s=u;break}var l=[];for(u=s;u<n.length;u++)l.push("..");return(l=l.concat(i.slice(s))).join("/")}function w(e){var r=m(e),t=r[0],n=r[1];return t||n?(n&&(n=n.substr(0,n.length-1)),t+n):"."}function y(e,r){var t=m(e)[2];return r&&t.substr(-1*r.length)===r&&(t=t.substr(0,t.length-r.length)),t}function T(e){return m(e)[3]}var x={extname:T,basename:y,dirname:w,sep:"/",delimiter:":",relative:j,join:b,isAbsolute:g,normalize:v,resolve:h};function E(e,r){if(e.filter)return e.filter(r);for(var t=[],n=0;n<e.length;n++)r(e[n],n,e)&&t.push(e[n]);return t}var O="b"==="ab".substr(-1)?function(e,r,t){return e.substr(r,t)}:function(e,r,t){return r<0&&(r=e.length+r),e.substr(r,t)},_=c(Object.freeze({__proto__:null,resolve:h,normalize:v,isAbsolute:g,join:b,relative:j,sep:"/",delimiter:":",dirname:w,basename:y,extname:T,default:x})),A="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function N(){throw new Error("setTimeout has not been defined")}function k(){throw new Error("clearTimeout has not been defined")}var S=N,q=k;function z(e){if(S===setTimeout)return setTimeout(e,0);if((S===N||!S)&&setTimeout)return S=setTimeout,setTimeout(e,0);try{return S(e,0)}catch(r){try{return S.call(null,e,0)}catch(r){return S.call(this,e,0)}}}"function"==typeof A.setTimeout&&(S=setTimeout),"function"==typeof A.clearTimeout&&(q=clearTimeout);var D,M=[],P=!1,C=-1;function L(){P&&D&&(P=!1,D.length?M=D.concat(M):C=-1,M.length&&R())}function R(){if(!P){var e=z(L);P=!0;for(var r=M.length;r;){for(D=M,M=[];++C<r;)D&&D[C].run();C=-1,r=M.length}D=null,P=!1,function(e){if(q===clearTimeout)return clearTimeout(e);if((q===k||!q)&&clearTimeout)return q=clearTimeout,clearTimeout(e);try{q(e)}catch(r){try{return q.call(null,e)}catch(r){return q.call(this,e)}}}(e)}}function H(e,r){this.fun=e,this.array=r}H.prototype.run=function(){this.fun.apply(null,this.array)};function V(){}var F=V,I=V,$=V,B=V,G=V,J=V,K=V;var Q=A.performance||{},U=Q.now||Q.mozNow||Q.msNow||Q.oNow||Q.webkitNow||function(){return(new Date).getTime()};var W=new Date;var X={nextTick:function(e){var r=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)r[t-1]=arguments[t];M.push(new H(e,r)),1!==M.length||P||z(R)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:F,addListener:I,once:$,off:B,removeListener:G,removeAllListeners:J,emit:K,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var r=.001*U.call(Q),t=Math.floor(r),n=Math.floor(r%1*1e9);return e&&(t-=e[0],(n-=e[1])<0&&(t--,n+=1e9)),[t,n]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-W)/1e3}};module.exports=void 0!==X&&"renderer"===X.type?require("./browser.js"):require("./node.js");var Y=c(Object.freeze({__proto__:null})),Z=o.isPrimitive,ee=s.isPrimitive,re=u,te=l;var ne=function(e,r){return re(r)?te(r,"dir")&&(e.dir=r.dir,!ee(e.dir))?new TypeError("invalid option. `dir` option must be a primitive string. Option: `"+e.dir+"`."):te(r,"open")&&(e.open=r.open,!Z(e.open))?new TypeError("invalid option. `open` option must be a primitive boolean. Option: `"+e.open+"`."):null:new TypeError("invalid argument. Options argument must be an object. Value: `"+r+"`.")},ie=l;var oe=function(e){var r={};return ie(e,"port")&&(r.port=e.port),ie(e,"maxport")&&(r.maxport=e.maxport),ie(e,"hostname")&&(r.hostname=e.hostname),ie(e,"address")&&(r.address=e.address),r},se=f,ue=Y("simple-http-server:404"),le=se("File not found");var ae=function(e,r){ue("Sending 404 response..."),r.statusCode=404,r.setHeader("Content-Type","text/plain"),r.setHeader("Content-Length",le.length),r.end(le)},fe=_.resolve,ce=a,de=ae,pe=Y("simple-http-server:request-listener");var me=function(e){return function(r,t){var n;pe("Received a request for %s",r.url),n=r.url.substring(1),""===(n=fe(e.dir,n)).substring(e.dir.length)&&(n=e.dir);pe("Request resolved to path %s",n),pe("Reading directory"),ce(n,(function(e,r){if(e&&("ENOENT"===e.code||"ENOTDIR"===e.code))return de()}))}},he=_,ve=e,ge=r,be=t,je=n,we=i,ye=ne,Te=oe,xe=me,Ee=Y("simple-http-server");var Oe=function(){var e,r,t,n,i,o,s;if(o={},1===arguments.length)be(arguments[0])?n=arguments[0]:s=ye(o,e=arguments[0]);else if(arguments.length>1){if(e=arguments[0],!be(n=arguments[1]))throw new TypeError("invalid argument. Callback argument must be a function. Value: `"+n+"`.");s=ye(o,e)}if(s)throw s;function u(e,t){var i;if(e)throw e;Ee("Server started."),(r=t).once("close",l),o.open&&(i=r.address(),je("http://"+i.address+":"+i.port)),n(null,r)}function l(){Ee("Server closed.")}void 0===n&&(n=we),o.dir&&(o.dir=he.resolve(ve(),o.dir)),Ee("Serving directory: %s",o.dir),t=e?Te(e):{},i=ge(t,xe(o)),Ee("Starting server..."),i(u)},_e=Oe;export{_e as default};
//# sourceMappingURL=index.mjs.map
