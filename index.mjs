import e from"debug";import r from"https://cdn.jsdelivr.net/gh/stdlib-js/process-cwd@esm/index.mjs";import t from"https://cdn.jsdelivr.net/gh/stdlib-js/net-http-server@esm/index.mjs";import n from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-function@esm/index.mjs";import i from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-open-url@esm/index.mjs";import s from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-noop@esm/index.mjs";import o from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-boolean@esm/index.mjs";import u from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-string@esm/index.mjs";import l from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-plain-object@esm/index.mjs";import a from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-has-own-property@esm/index.mjs";import d from"https://cdn.jsdelivr.net/gh/stdlib-js/fs-read-dir@esm/index.mjs";import p from"https://cdn.jsdelivr.net/gh/stdlib-js/buffer-from-string@esm/index.mjs";function m(e){if(e.__esModule)return e;var r=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})})),r}function f(e,r){for(var t=0,n=e.length-1;n>=0;n--){var i=e[n];"."===i?e.splice(n,1):".."===i?(e.splice(n,1),t++):t&&(e.splice(n,1),t--)}if(r)for(;t--;t)e.unshift("..");return e}var c=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,v=function(e){return c.exec(e).slice(1)};function h(){for(var e="",r=!1,t=arguments.length-1;t>=-1&&!r;t--){var n=t>=0?arguments[t]:"/";if("string"!=typeof n)throw new TypeError("Arguments to path.resolve must be strings");n&&(e=n+"/"+e,r="/"===n.charAt(0))}return(r?"/":"")+(e=f(T(e.split("/"),(function(e){return!!e})),!r).join("/"))||"."}function g(e){var r=b(e),t="/"===_(e,-1);return(e=f(T(e.split("/"),(function(e){return!!e})),!r).join("/"))||r||(e="."),e&&t&&(e+="/"),(r?"/":"")+e}function b(e){return"/"===e.charAt(0)}function j(){var e=Array.prototype.slice.call(arguments,0);return g(T(e,(function(e,r){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))}function x(e,r){function t(e){for(var r=0;r<e.length&&""===e[r];r++);for(var t=e.length-1;t>=0&&""===e[t];t--);return r>t?[]:e.slice(r,t-r+1)}e=h(e).substr(1),r=h(r).substr(1);for(var n=t(e.split("/")),i=t(r.split("/")),s=Math.min(n.length,i.length),o=s,u=0;u<s;u++)if(n[u]!==i[u]){o=u;break}var l=[];for(u=o;u<n.length;u++)l.push("..");return(l=l.concat(i.slice(o))).join("/")}function y(e){var r=v(e),t=r[0],n=r[1];return t||n?(n&&(n=n.substr(0,n.length-1)),t+n):"."}function w(e,r){var t=v(e)[2];return r&&t.substr(-1*r.length)===r&&(t=t.substr(0,t.length-r.length)),t}function O(e){return v(e)[3]}var E={extname:O,basename:w,dirname:y,sep:"/",delimiter:":",relative:x,join:j,isAbsolute:b,normalize:g,resolve:h};function T(e,r){if(e.filter)return e.filter(r);for(var t=[],n=0;n<e.length;n++)r(e[n],n,e)&&t.push(e[n]);return t}var _="b"==="ab".substr(-1)?function(e,r,t){return e.substr(r,t)}:function(e,r,t){return r<0&&(r=e.length+r),e.substr(r,t)},A=m(Object.freeze({__proto__:null,resolve:h,normalize:g,isAbsolute:b,join:j,relative:x,sep:"/",delimiter:":",dirname:y,basename:w,extname:O,default:E})),S=o.isPrimitive,P=u.isPrimitive,C=l,R=a;var k=function(e,r){return C(r)?R(r,"dir")&&(e.dir=r.dir,!P(e.dir))?new TypeError("invalid option. `dir` option must be a primitive string. Option: `"+e.dir+"`."):R(r,"open")&&(e.open=r.open,!S(e.open))?new TypeError("invalid option. `open` option must be a primitive boolean. Option: `"+e.open+"`."):null:new TypeError("invalid argument. Options argument must be an object. Value: `"+r+"`.")},q=a;var z=function(e){var r={};return q(e,"port")&&(r.port=e.port),q(e,"maxport")&&(r.maxport=e.maxport),q(e,"hostname")&&(r.hostname=e.hostname),q(e,"address")&&(r.address=e.address),r},M=p,N=e("simple-http-server:404"),D=M("File not found");var H=function(e,r){N("Sending 404 response..."),r.statusCode=404,r.setHeader("Content-Type","text/plain"),r.setHeader("Content-Length",D.length),r.end(D)},V=A.resolve,F=d,I=H,L=e("simple-http-server:request-listener");var $=function(e){return function(r,t){var n;L("Received a request for %s",r.url),n=r.url.substring(1),""===(n=V(e.dir,n)).substring(e.dir.length)&&(n=e.dir);L("Request resolved to path %s",n),L("Reading directory"),F(n,(function(e,r){if(e&&("ENOENT"===e.code||"ENOTDIR"===e.code))return I()}))}},B=A,G=r,J=t,K=n,Q=i,U=s,W=k,X=z,Y=$,Z=e("simple-http-server");var ee=function(){var e,r,t,n,i,s,o;if(s={},1===arguments.length)K(arguments[0])?n=arguments[0]:o=W(s,e=arguments[0]);else if(arguments.length>1){if(e=arguments[0],!K(n=arguments[1]))throw new TypeError("invalid argument. Callback argument must be a function. Value: `"+n+"`.");o=W(s,e)}if(o)throw o;function u(e,t){var i;if(e)throw e;Z("Server started."),(r=t).once("close",l),s.open&&(i=r.address(),Q("http://"+i.address+":"+i.port)),n(null,r)}function l(){Z("Server closed.")}void 0===n&&(n=U),s.dir&&(s.dir=B.resolve(G(),s.dir)),Z("Serving directory: %s",s.dir),t=e?X(e):{},i=J(t,Y(s)),Z("Starting server..."),i(u)},re=ee;export{re as default};
